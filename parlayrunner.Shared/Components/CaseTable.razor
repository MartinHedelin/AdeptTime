@using parlayrunner.Shared.Models

<div class="case-table-container">
    <div class="table-wrapper">
        <table class="case-table">
            <thead>
                <tr>
                    <th class="status-col">Status</th>
                    <th class="case-number-col">Sags nr.</th>
                    <th class="description-col">Beskrivelse</th>
                    <th class="comment-col">Kommentar</th>
                    <th class="customer-col">Kunde</th>
                    <th class="employee-col">Administration/Manager</th>
                    <th class="department-col">Afdeling</th>
                    <th class="hours-col">Udf√∏rte timer</th>
                    <th class="hours-col">Timer total</th>
                    <th class="date-col">Start dato</th>
                    <th class="date-col">Slut dato</th>
                    <th class="filter-col">Filter</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var caseItem in Cases)
                {
                    <tr class="table-row clickable" @onclick="() => HandleCaseClick(caseItem)">
                        <td class="status-col">
                            <span class="status-badge @GetStatusClass(caseItem.Status)">
                                @GetStatusText(caseItem.Status)
                            </span>
                        </td>
                        <td class="case-number-col">
                            <span class="case-number">@caseItem.CaseNumber</span>
                        </td>
                        <td class="description-col">
                            <span class="description-text">@caseItem.Description</span>
                        </td>
                        <td class="comment-col">
                            <span class="comment-text">@caseItem.Comment</span>
                        </td>
                        <td class="customer-col">
                            <span class="customer-name">@caseItem.Customer.Name</span>
                        </td>
                        <td class="employee-col">
                            <div class="employee-info">
                                <img src="@caseItem.Manager.AvatarUrl" alt="@caseItem.Manager.Name" class="employee-avatar" />
                                <div class="employee-details">
                                    <div class="employee-name">@caseItem.Manager.Name</div>
                                    <div class="employee-team">@caseItem.Manager.Team</div>
                                </div>
                            </div>
                        </td>
                        <td class="department-col">
                            <span class="department-text">@caseItem.Department</span>
                        </td>
                        <td class="hours-col">
                            <span class="hours-number">@caseItem.CompletedHours</span>
                        </td>
                        <td class="hours-col">
                            <span class="hours-number">@caseItem.TotalHours</span>
                        </td>
                        <td class="date-col">
                            <span class="date-text">@caseItem.StartDate.ToString("dd MMMM yyyy")</span>
                        </td>
                        <td class="date-col">
                            <span class="date-text">@caseItem.EndDate.ToString("dd MMMM yyyy")</span>
                        </td>
                        <td class="filter-col">
                            <div class="attachment-info">
                                <i class="fas fa-paperclip"></i>
                                <span class="attachment-count">@caseItem.AttachmentCount</span>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<style>
    .case-table-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        overflow: hidden;
    }

    .table-wrapper {
        overflow-x: auto;
    }

    .case-table {
        width: 100%;
        border-collapse: collapse;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        min-width: 1200px;
    }

    .case-table thead {
        background-color: #f8f9fa;
        border-bottom: 1px solid #e9ecef;
    }

    .case-table th {
        padding: 16px 12px;
        text-align: left;
        font-weight: 600;
        font-size: 14px;
        color: #495057;
        border-right: 1px solid #e9ecef;
        white-space: nowrap;
    }

    .case-table th:last-child {
        border-right: none;
    }

    .table-row {
        border-bottom: 1px solid #e9ecef;
        transition: background-color 0.2s ease;
    }

    .table-row:hover {
        background-color: #f8f9fa;
    }

    .table-row.clickable {
        cursor: pointer;
    }

    .table-row.clickable:hover {
        background-color: #e9ecef;
    }

    .case-table td {
        padding: 16px 12px;
        vertical-align: middle;
        border-right: 1px solid #e9ecef;
        font-size: 14px;
    }

    .case-table td:last-child {
        border-right: none;
    }

    .status-col {
        width: 100px;
    }

    .status-badge {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .status-badge.active {
        background-color: #d4edda;
        color: #155724;
    }

    .status-badge.pending {
        background-color: #fff3cd;
        color: #856404;
    }

    .status-badge.review {
        background-color: #cce5ff;
        color: #004085;
    }

    .status-badge.completed {
        background-color: #e2e3e5;
        color: #495057;
    }

    .case-number-col {
        width: 140px;
    }

    .case-number {
        font-weight: 600;
        color: #495057;
        font-family: 'Monaco', monospace;
        font-size: 13px;
    }

    .description-col {
        width: 300px;
        max-width: 300px;
    }

    .description-text {
        color: #495057;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .comment-col {
        width: 250px;
        max-width: 250px;
    }

    .comment-text {
        color: #6c757d;
        font-style: italic;
        line-height: 1.4;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .customer-col {
        width: 150px;
    }

    .customer-name {
        color: #495057;
        font-weight: 500;
    }

    .employee-col {
        width: 180px;
    }

    .employee-info {
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .employee-avatar {
        width: 36px;
        height: 36px;
        border-radius: 50%;
        object-fit: cover;
    }

    .employee-details {
        display: flex;
        flex-direction: column;
    }

    .employee-name {
        font-weight: 600;
        color: #212529;
        font-size: 14px;
    }

    .employee-team {
        font-size: 12px;
        color: #6c757d;
        margin-top: 2px;
    }

    .department-col {
        width: 80px;
    }

    .department-text {
        color: #495057;
        font-weight: 500;
    }

    .hours-col {
        width: 100px;
        text-align: center;
    }

    .hours-number {
        color: #495057;
        font-weight: 600;
    }

    .date-col {
        width: 120px;
    }

    .date-text {
        color: #495057;
        font-size: 13px;
    }

    .filter-col {
        width: 80px;
        text-align: center;
    }

    .attachment-info {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        color: #6c757d;
    }

    .attachment-count {
        font-size: 13px;
        font-weight: 500;
    }

    @@media (max-width: 768px) {
        .case-table th,
        .case-table td {
            padding: 12px 8px;
            font-size: 13px;
        }

        .employee-avatar {
            width: 32px;
            height: 32px;
        }

        .description-col,
        .comment-col {
            max-width: 200px;
        }
    }
</style>

@code {
    [Parameter] public List<Case> Cases { get; set; } = new();
    [Parameter] public EventCallback<Case> OnCaseSelected { get; set; }

    private async Task HandleCaseClick(Case caseItem)
    {
        await OnCaseSelected.InvokeAsync(caseItem);
    }

    private string GetStatusClass(CaseStatus status)
    {
        return status switch
        {
            CaseStatus.Badges => "active",
            CaseStatus.Pending => "pending",
            CaseStatus.Review => "review",
            CaseStatus.Completed => "completed",
            _ => "active"
        };
    }

    private string GetStatusText(CaseStatus status)
    {
        return status switch
        {
            CaseStatus.Badges => "Badges",
            CaseStatus.Pending => "Pending",
            CaseStatus.Review => "Review",
            CaseStatus.Completed => "Completed",
            _ => "Badges"
        };
    }
} 